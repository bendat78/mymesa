31.3.18
Routing shader-db's run stderr to /dev/null makes no sense. 	Change README ?
No need to enable debug build for radeonsi.			Change README ?

No synchronization between shader-db's run and si-report.py: premature end cannot be detected
How about run emits Done when its done and si-report looks for that?

With a debug build of mesa -O0 and --enable-debug instead of release with -O3 only a part of the available shaders is compiled (~12%). Bug ?

Also some shaders are compiled twice with different results (both debug and non-debug build) also happens with tgsi: Bug ?

Non-debug build NIR
shaders/csgo/595.shader_test - Shader Stats: SGPRS: 16 VGPRS: 20 Code Size: 444 LDS: 0 Scratch: 0 Max Waves: 8 Spilled SGPRs: 0 Spilled VGPRs: 0 PrivMem VGPRs: 0
shaders/csgo/595.shader_test - Shader Stats: SGPRS: 16 VGPRS: 16 Code Size: 72 LDS: 0 Scratch: 0 Max Waves: 8 Spilled SGPRs: 0 Spilled VGPRs: 0 PrivMem VGPRs: 0

Debug build NIR
shaders/csgo/595.shader_test - Shader Stats: SGPRS: 16 VGPRS: 20 Code Size: 444 LDS: 0 Scratch: 0 Max Waves: 8 Spilled SGPRs: 0 Spilled VGPRs: 0 PrivMem VGPRs: 0
shaders/csgo/595.shader_test - Shader Stats: SGPRS: 16 VGPRS: 16 Code Size: 72 LDS: 0 Scratch: 0 Max Waves: 8 Spilled SGPRs: 0 Spilled VGPRs: 0 PrivMem VGPRs: 0

Debug build TGSI
shaders/csgo/595.shader_test - Shader Stats: SGPRS: 16 VGPRS: 20 Code Size: 456 LDS: 0 Scratch: 0 Max Waves: 8 Spilled SGPRs: 0 Spilled VGPRs: 0 PrivMem VGPRs: 0
shaders/csgo/595.shader_test - Shader Stats: SGPRS: 16 VGPRS: 16 Code Size: 76 LDS: 0 Scratch: 0 Max Waves: 8 Spilled SGPRs: 0 Spilled VGPRs: 0 PrivMem VGPRs: 0

Non-debug build TGSI
shaders/csgo/595.shader_test - Shader Stats: SGPRS: 16 VGPRS: 20 Code Size: 456 LDS: 0 Scratch: 0 Max Waves: 8 Spilled SGPRs: 0 Spilled VGPRs: 0 PrivMem VGPRs: 0
shaders/csgo/595.shader_test - Shader Stats: SGPRS: 16 VGPRS: 16 Code Size: 76 LDS: 0 Scratch: 0 Max Waves: 8 Spilled SGPRs: 0 Spilled VGPRs: 0 PrivMem VGPRs: 0

Also lots of these:
shaders/csgo/595.shader_test - LLVM diagnostic (remark): <unknown>:0:0: 75 instructions in function
tried debug build of mesa doesnt go away - Meaning?

30.3.18
uneven results with shader-db, it seems on the whole nir could be better than tgsi, but there are some shaders with significant regressions
see run directory for comparisons of tgsi vs nir for different versions of llvm and tgsi/nir with different llvm backends also includes complete shader db out put (around 50k shaders)
overall nir gets better with every version increase of llvm, which optimizes for code size (why not speed ?)

XCom doesnt start
Workaround: create steam_appid.txt in binaries directory and start binaries/linux/game.x86_64 directly
otherwise fine

XCom 2 works fine

X3: Albion Prelude doesnt start
Workaround start X3AP_main directly
otherwise fine

Euro Truck Simulator 2 works fine


29.3.18
Empire: Total War
Fonts in Menus are garbled independent of nir
Workaround:
gedit ~/.local/share/feral-interactive/Empire/preferences
change UsePBOSurfaces from 1 to 0
Bug ?
otherwise fine

Medieval II: Total War
Fullscreen works only if the window doesnt have focus - so unplayable
Workaround:
gedit ~/.local/share/feral-interactive/Medieval\ II\ Total\ War/preferences
change Fullscreen from 1 to 0
Bug ?
otherwise fine

Total War: Shogun 2 works

Total War: WARHAMMER requires workaround to start:
sudo ln -s /usr/lib/x86_64-linux-gnu/librtmp.so.1 /usr/lib/x86_64-linux-gnu/librtmp.so.0
more stuttering with nir (see screenshot) otherwise works fine
TGSI avg 24.2 fps, NIR avg 24.3 fps

Warhammer 40k: Dawn of War II
rendering in Warhammer 40k: Dawn of War II breaks with the commit below.
In the menu only black and white shadows appear instead of 3d figure (see screenshot). In the game no 3d objects are visible only colorful shadows.

Works fine with 17.3.7.


a0c8b49284efe736849c0a45920ad0a1bbd8d93d is the first bad commit
commit a0c8b49284efe736849c0a45920ad0a1bbd8d93d
Author: Marek Olšák <marek.olsak@amd.com>
Date:   Wed Feb 14 20:13:40 2018 +0100

    mesa: enable OpenGL 3.1 with ARB_compatibility
    
    Tested-by: Dieter Nützel <Dieter@nuetzel-hh.de>
    Reviewed-by: Brian Paul <brianp@vmware.com>

:040000 040000 e77355f4d5979f42b5e8f55dd6c6ea62cba32ff3 24f0fe1b3e5f9d1daa801a706299f0115f9d8f2d M	docs
:040000 040000 89d6cc6fe13b05f4625fb48abbb94050f0cb5c96 3b91e5c0091caf1426b09568846f8f2b3bc64803 M	src
'bisect run' erfolgreich ausgeführt

17.3.18

Talos principle benchmark llvm 5.0.1 all options ultra, resolution 1920x1080 (render and display)
TGSI avg 36.7/37.3/37.1
NIR avg 35.7/36.8/37

Talos principle benchmark llvm 7 git all options ultra, resolution 1920x1080 (render and display)
TGSI avg 37.6/38.2/38
NIR avg 36.6/37.3/37.5

7.3.18

Limiting the loop unrolling has resolved the performance problem for bioshock infinite

comparing the CPU load of TGSI and NIR it doesnt seem to be an issue
does NIR generate inefficent shaders making framerate GPU bound more often?

6.3.18

Deus Ex: when using nir crashes three times during shader generation:
	half way (harddrive is active: writes crashdump?), 3/4 (crash dump?, kills steam), 99% full system freeze

BioShock Infinite Steam Launcher Options:
R600_DEBUG=nir %command% DefaultPCBenchmarkMap.xcmap -unattended -fullscreen -noPauseOnLossOfFocus

Phorononix System Information (!! = incorrectly detected)

  PROCESSOR:          Intel Xeon E31260L @ 3.30GHz
    Core Count:       4
    Thread Count:     8
    Extensions:       SSE 4.2 + AVX
    Cache Size:       8192 KB
    Microcode:        0x29
    Scaling Driver:   intel_pstate powersave

  GRAPHICS:           MSI AMD Radeon 4096MB
!!    OpenGL:           4.5 Mesa 18.1.0-dev-ben-Mo 5. Mr 09:17:09 CET 2018 (git-b352b692d2) (LLVM 5.0.0) !! (actually oibaf for 32-bit)
    Vulkan:           1.0.49
    OpenCL:           OpenCL 1.1 Mesa 18.1.0-dev-ben-Mo 5. Mr 09:17:09 CET 2018 (git-b352b692d2)
    Display Driver:   modesetting 1.19.5
    Monitor:          BenQ G2412HD
    Screen:           1920x1080

  MOTHERBOARD:        Intel DQ67OW
    BIOS Version:     SWQ6710H.86A.0068.2017.0601.1423
    Chipset:          Intel Xeon E3-1200 Family DRAM
    Audio:            Realtek ALC888
    Network:          Intel 82579LM Gigabit Connection

  MEMORY:             8192MB

  DISK:               960GB OCZ TRION100
    File-System:      ext4
    Mount Options:    data=ordered errors=remount-ro relatime rw
    Disk Scheduler:   CFQ

  OPERATING SYSTEM:   Ubuntu 17.10
    Kernel:           4.16.0-rc4 (x86_64) 20180305
    Desktop:          GNOME Shell 3.26.2
!!    Compiler:         Clang 4.0.1-6 + LLVM 5.0.0 !! (actually ccache and gcc 7.2.0)
    Security:         KPTI + __user pointer sanitization + Full generic retpoline Protection


5.3.18

Dead Island crashes while generating shaders

The Valley - works

SpecOps the Line - works nonir 53 to 60 fps, nir 37 to 60 fps

Dying Light - works, nonir 29 to 51, nir 31 to 52 one crash during shader generation

3.3.18

Tested on Ubuntu 17.10 with mesa git of today 
(oibaf for 32 bit, mine with LLVM5.0 on 64 bit because I cant figure out how to build 32bit drivers on ubuntu :( )
Xeon 1260l and 8GB DDR3-10600 with RX460 4GB

works means no obvious visual artifacts etc.

Alien Isolation - works

Bioshock Infinite - works nonir Overall avg 45.58, min 9.81, max 104.49; nir avg 31.47 min 8.35 max 94.19

CAT Interstellar (UE4) - works

Dead Island Definitive - works

Dead Island Riptide Definitive - works

Deus Ex: Mankind Divided - works, nonir low 8.3 avg 24.2 high 37.6; nir low 1 avg 22.8 high 35.8
	but shadergeneration crashes two times: once around half the loader bar with complete system freeze and then again around the end but only exiting the application

Mad Max[vulcan beta] - works, nir seems be a bit slower except for one benchmark
	benchmark 1
	nonir	43/45/47
	nir	10/46/50
	benchmark 2
	nonir	14/37/41
	nir	24/36/40
	benchmark 3
	nonir	8/43/61
	nir	5/41/61
	benchmark 4
	nonir	9/49/78
	nir	4/47/74

Tomb Raider - TressFX doesn't work: hair flickering and is riddled with small green block artifacts, smoothing is missing; speed is the same 28.6 ish

Hitman GO (Unity) - works

Unity of Command (PyGame,SDL) - works

Talos Principle Benchmark nir 64.7 nonir 67
